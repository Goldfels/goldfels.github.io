<!DOCTYPE html>
<html lang="en">
	<title>SVG Editor</title>
	<head>
		<style>
			* {
				box-sizing: border-box;
			}
			body {
				color: #888;
				background: #eee;
				font-family: sans-serif;
				font-size: 13px;
			}
			button {
				width: 100%;
				color: #888;
				background-color: transparent;
				border: 1px solid #ccc;
				padding: 4px 8px;
				text-transform: uppercase;
				cursor: pointer;
				outline: none;
			}
			button:hover {
				color: #fff;
				border: transparent;
				background-color: #999;
			}
			input {
				color: #888;
				padding: 4px 8px;
			}
			hr {
				border: 0;
				padding: 2px 0px;
			}
			#tools {
				padding: 0px 10px;
				display: inline-block;
				width: 110px;
				line-height: 24px;
				vertical-align: top;
			}
			#content {
				display: inline-block;
				width: 600px;
			}
				#stage {
					background: #fff;
				}
				#stage.wireframe * {
					stroke: #000 !important;
					stroke-width: 1px !important;
					fill: transparent !important;
				}
		</style>
	</head>
	<body>
		<span id="tools">
			<input id="title" value="Untitled" style="width:100%"></input>
			<hr/>
			<button id="load">Load</button>
			<button id="save">Save</button>
			<button id="clear">Clear</button>
		</span>
		<span id="content">
			<svg id="stage" width="600" height="400" viewBox="0 0 600 400"></svg>
			<input id="textarea" type="hidden"></input>
		</span>

	    <script type="text/javascript" src="js/jquery-2.2.4.min.js"></script>
	    <script type="text/javascript" src="js/jquery-ui.min.js"></script>
	    <script type="text/javascript" src="js/d3.js"></script>
	    <script type="text/javascript" src="js/jquery.svgedit.js"></script>
		<script>

			const NS = 'http://www.w3.org/2000/svg';

			const WIDTH = 600;
			const HEIGHT = 400;

			function parseNumber( value ) {

				return parseFloat( value.toFixed( 2 ) );

			}

			function randomColor() {

				return '#'+Math.floor(Math.random()*16777215).toString(16);

			}

			$(document).ready (function ()
			{
				$('#stage').svgedit();
			});

			//createCircle.addEventListener( 'click', function () {

			//	var element = document.createElementNS( NS, 'circle' );
			//	element.setAttribute( 'cx', parseNumber( Math.random() * WIDTH ) );
			//	element.setAttribute( 'cy', parseNumber( Math.random() * HEIGHT ) );
			//	element.setAttribute( 'r', parseNumber( Math.random() * 100 ) );
			//	element.style.stroke = 'black';
			//	element.style.fill = randomColor();

			//	$('#stage').svgedit('addElement', element);

			//} );

			// LOAD
			// TODO: move to function

			var form = document.createElement( 'form' );
			form.style.display = 'none';
			document.body.appendChild( form );

			var input = document.createElement( 'input' );
			input.type = 'file';
			input.addEventListener( 'change', function ( event ) {

				var file = input.files[ 0 ];

				title.value = file.name.split( '.' )[ 0 ];

				var reader = new FileReader();
				reader.addEventListener( 'load', function ( event ) {

					var contents = event.target.result;
					$('#stage').svgedit('setContent', new DOMParser().parseFromString( contents, 'image/svg+xml' ) );

				}, false );
				reader.readAsText( file );

				form.reset();

			} );
			form.appendChild( input );

			load.addEventListener( 'click', function () {

				input.click();

			} );

			// SAVE

			save.addEventListener( 'click', function () {
				$('#stage').svgedit('save');
			} );

			// CLEAR

			clear.addEventListener( 'click', function () {

				$('#stage').svgedit('clear');

			} );

		</script>

	</body>
</html>
